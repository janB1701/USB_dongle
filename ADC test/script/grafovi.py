import matplotlib.pyplot as plt
import numpy as np

# Primjer podataka iz dumpa (signed integers)
adc_signed_values = [1135, 1074, 1072, 1057, 986, 939, 872, 878, 934, 850, 833, 777, 747, 748, 715, 705, 699, 681, 707, 636, 624, 587, 664, 593, 591, 642, 616, 608, 583, 604, 631, 570, 602, 677, 727, 674, 717, 751, 730, 767, 735, 769, 826, 868, 946, 879, 906, 999, 1025, 1077, 1134, 1124, 1106, 1166, 1187, 1214, 1311, 1333, 1341, 1380, 1393, 1449, 1467, 1478, 1518, 1578, 1519, 1605, 1599, 1649, 1709, 1693, 1751, 1734, 1730, 1762, 1809, 1773, 1804, 1779, 1851, 1767, 1857, 1898, 1851, 1821, 1869, 1851, 1943, 1867, 1816, 1824, 1772, 1773, 1737, 1710, 1724, 1733, 1656, 1626, 1602, 1596, 1596, 1604, 1500, 1474, 1493, 1455, 1480, 1352, 1306, 1294, 1297, 1273, 1217, 1166, 1168, 1083, 1065, 1095, 1020, 1007, 968, 936, 904, 863, 887, 890, 807, 797, 753, 723, 725, 679, 690, 682, 654, 639, 626, 642, 605, 599, 641, 704, 608, 648, 592, 592, 601, 591, 651, 666, 712, 721, 683, 790, 769, 767, 814, 884, 832, 905, 901, 930, 999, 1007, 1043, 1048, 1086, 1073, 1105, 1199, 1223, 1284, 1320, 1372, 1366, 1432, 1431, 1436, 1445, 1542, 1516, 1579, 1625, 1589, 1656, 1683, 1670, 1711, 1744, 1755, 1771, 1784, 1846, 1833, 1844, 1857, 1826, 1829


]


VREF = 3.3
ADC_MAX = 4095

# Preračun u voltove
voltages = [v * VREF / ADC_MAX for v in adc_signed_values]

# Izračun DC offseta i amplitude
dc_offset = np.mean(voltages)
amplitude = (np.max(voltages) - np.min(voltages)) / 2

print(f"DC offset: {dc_offset:.3f} V")
print(f"Amplitude: {amplitude:.3f} V")

# Crtanje grafa
plt.plot(voltages)
plt.title("ADC Signal (converted to Voltage)")
plt.xlabel("Sample index")
plt.ylabel("Voltage (V)")
plt.grid(True)
plt.show()
